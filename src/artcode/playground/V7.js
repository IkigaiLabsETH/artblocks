let rules = {
    "000":"010",
    "001":"001",
    "002":"002",
    "003":"003",
    "010":"010",
    "011":"011",
    "012":"120",
    "013":"001",
    "020":"020",
    "021":"002",
    "022":"022",
    "023":"030",
    "030":"030",
    "031":"010",
    "032":"003",
    "033":"033",
    "100":"100",
    "101":"131",
    "102":"120",
    "103":"013",
    "110":"110",
    "111":"020",
    "112":"120",
    "113":"011",
    "120":"200",
    "121":"121",
    "122":"220",
    "123":"230",
    "130":"010",
    "131":"010",
    "132":"013",
    "133":"013",
    "200":"200",
    "201":"021",
    "202":"212",
    "203":"230",
    "210":"021",
    "211":"021",
    "212":"020",
    "213":"021",
    "220":"220",
    "221":"022",
    "222":"030",
    "223":"230",
    "230":"300",
    "231":"310",
    "232":"232",
    "233":"330",
    "300":"300",
    "301":"310",
    "302":"032",
    "303":"323",
    "310":"100",
    "311":"110",
    "312":"120",
    "313":"313",
    "320":"032",
    "321":"032",
    "322":"032",
    "323":"030",
    "330":"330",
    "331":"310",
    "332":"033",
    "333":"000",
  }
  
  rules = {
    "000":"030",
    "001":"001",
    "002":"002",
    "003":"003",
    "010":"010",
    "011":"011",
    "012":"120",
    "013":"001",
    "020":"020",
    "021":"002",
    "022":"022",
    "023":"030",
    "030":"030",
    "031":"010",
    "032":"003",
    "033":"033",
    "100":"100",
    "101":"121",
    "102":"120",
    "103":"013",
    "110":"110",
    "111":"000",
    "112":"120",
    "113":"011",
    "120":"200",
    "121":"121",  
    "122":"220",
    "123":"230",
    "130":"010",
    "131":"010",  
    "132":"013",
    "133":"013",
    "200":"200",
    "201":"021",
    "202":"232",
    "203":"230",
    "210":"021",
    "211":"021",
    "212":"020",
    "213":"021",
    "220":"220",
    "221":"022",
    "222":"010",
    "223":"230",
    "230":"300",
    "231":"310",
    "232":"232",
    "233":"330",
    "300":"300",
    "301":"310",
    "302":"032",
    "303":"313",
    "310":"100",
    "311":"110",
    "312":"120",
    "313":"313",
    "320":"032",
    "321":"032",
    "322":"032",
    "323":"030",
    "330":"330",
    "331":"310",
    "332":"033",
    "333":"020",
  }
  
  
  
  function evolve(cells){
    let n = cells.length;
    let res = new Array(n).fill('');
    for (let i = 0; i < n; i++){
      let a = cells[(i-1+n)%n].toString();
      let b = cells[i].toString();
      let c = cells[(i+1)%n].toString();
      let r = rules[a+b+c].split('').map(Number);
      res[i] = r[1];
    }
    return res;
  }
  
  let state = [];
  
  function draw_state(){
    for (let i = 0; i < state.length; i++){
      fill(["red","blue","green","white"][state[i]]) // Modify the color palette here.
      rect(i*10,0,10,10);
    }
    translate(0,10);
  }
  
  function setup() {
    createCanvas(4000, 4000);
    
    for (let i = 0; i < 1000; i++){
      state.push(~~random(4))
    }
    draw_state();
    console.log(state);
    for (let i = 0; i < 1000; i++){
      state = evolve(state);
      console.log(state);
      draw_state();
    }
  }
  
  function draw() {
  
  }